import{_ as k}from"./PageContainer-jsAxyEWn.js";import{ae as x,ad as U,r as p,o as F,j as h,k as l,J as e,ab as _,bR as y,an as i}from"./index-CyOCBvwo.js";import{E as R,a as S}from"./el-col-BL3QdXh5.js";import{E as C,a as N}from"./el-form-item-CDkAznBE.js";import{E as P}from"./_plugin-vue_export-helper-vTAooe8W.js";import{E as q}from"./el-input-BoF7YTLz.js";import"./el-message-CM5pjKzM.js";const H={__name:"UserPassword",setup(B){const w=x(),n=U(),u=p(),r=p({old_pwd:n.user.password,new_pwd:"",re_pwd:""}),c=p({old_pwd:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:6,max:15,message:"原密码长度在6-15位之间",trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:15,message:"新密码长度在6-15位之间",trigger:"blur"},{validator:(d,o,t)=>{o===r.value.old_pwd?t(new Error("新密码不能与原密码一样")):t()},trigger:"blur"}],re_pwd:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{min:6,max:15,message:"确认密码长度在6-15位之间",trigger:"blur"},{validator:(d,o,t)=>{o!==r.value.new_pwd?t(new Error("确认密码必须和新密码一样")):t()},trigger:"blur"}]}),f=async()=>{await u.value.validate(),(await y(r.value)).data.code===0?(i.success("密码修改成功"),n.setToken(""),n.setUser({}),w.push("/login")):i.error("密码修改失败")},g=async()=>{u.value.resetFields()};return(d,o)=>{const t=q,a=C,m=P,v=N,b=R,E=S,V=k;return F(),h(V,{title:"修改密码"},{"page-content":l(()=>[e(E,null,{default:l(()=>[e(b,{span:12},{default:l(()=>[e(v,{ref_key:"formRef",ref:u,model:r.value,rules:c.value,"label-width":"100px"},{default:l(()=>[e(a,{label:"原密码",prop:"old_pwd"},{default:l(()=>[e(t,{modelValue:r.value.old_pwd,"onUpdate:modelValue":o[0]||(o[0]=s=>r.value.old_pwd=s),"show-password":""},null,8,["modelValue"])]),_:1}),e(a,{label:"新密码",prop:"new_pwd"},{default:l(()=>[e(t,{modelValue:r.value.new_pwd,"onUpdate:modelValue":o[1]||(o[1]=s=>r.value.new_pwd=s),"show-password":""},null,8,["modelValue"])]),_:1}),e(a,{label:"确认密码",prop:"re_pwd"},{default:l(()=>[e(t,{modelValue:r.value.re_pwd,"onUpdate:modelValue":o[2]||(o[2]=s=>r.value.re_pwd=s),"show-password":""},null,8,["modelValue"])]),_:1}),e(a,null,{default:l(()=>[e(m,{type:"primary",onClick:f},{default:l(()=>[_("修改密码")]),_:1}),e(m,{onClick:g},{default:l(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}};export{H as default};
